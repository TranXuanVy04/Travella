@model Trave.Models.Booking

@{
    ViewBag.Title = "Xác nhận và Thanh toán";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* CSS Tùy chỉnh nhỏ để làm nổi bật các lựa chọn thanh toán */
    .payment-option {
        transition: all 0.2s ease-in-out;
        border: 1px solid #dee2e6;
    }

        .payment-option:hover {
            border-color: #0d6efd; /* Màu primary của Bootstrap */
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
    /* Đảm bảo nền plaintext không quá xám */
    .form-control-plaintext {
        background-color: #f8f9fa; /* Màu bg-light */
        padding: 0.5rem 0.75rem;
        border-radius: 6px;
    }
</style>
<!-- Header Start -->
<div class="container-fluid bg-breadcrumb">
    <div class="container text-center py-5" style="max-width: 900px;">
        <h1 class="text-white display-3 mb-4">
            Book tour
        </h1>
        <ol class="breadcrumb justify-content-center mb-0">
            <li class="breadcrumb-item"><a href="@Url.Action("index","home")">Home</a></li>
            <li class="breadcrumb-item"><a href="#">Pages</a></li>
            <li class="breadcrumb-item active text-white">@Model.Tour.TenTour</li>
        </ol>
    </div>
</div>
<!-- Header End -->
<div class="container py-5">

    @using (Html.BeginForm("ProcessPayment", "home", FormMethod.Post))
    {
        @Html.AntiForgeryToken()

        @Html.HiddenFor(m => m.MaTour)
        @Html.HiddenFor(m => m.MaKH)
        @Html.HiddenFor(m => m.NgayDi)
        @Html.HiddenFor(m => m.SoNguoi)
        @Html.HiddenFor(m => m.TongGia)

        <div class="row g-5">

            <div class="col-lg-7">

                <h1 class="fw-light mb-4">Hoàn tất Đặt tour</h1>

                <h2 class="h4 mb-3"><i class="fas fa-user-check text-primary me-2"></i> 1. Thông tin Khách hàng</h2>
                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body p-4">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Họ tên</label>
                                <input type="text" class="form-control-plaintext" value="@Model.KhachHang.TenKH" readonly>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Số điện thoại</label>
                                <input type="text" class="form-control-plaintext" value="@Model.KhachHang.SoDT" readonly>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Email</label>
                                <input type="text" class="form-control-plaintext" value="@Model.KhachHang.Email" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <h2 class="h4 mt-5 mb-3"><i class="fas fa-credit-card text-primary me-2"></i> 2. Phương thức Thanh toán</h2>
                <div class="list-group">
                    <label class="list-group-item list-group-item-action d-flex align-items-center p-3 payment-option">
                        <input type="radio" name="PhuongThucThanhToan" value="VnPay" class="form-check-input mt-0" checked>
                        <img src="/img/vnpay-logo.png" style="height: 30px; margin: 0 15px;">
                        <div class="flex-fill">
                            <strong class="d-block">Thanh toán qua VNPay</strong>
                            <small class="text-muted">Thanh toán an toàn, nhanh chóng qua cổng VNPay.</small>
                        </div>
                    </label>
                    <label class="list-group-item list-group-item-action d-flex align-items-center p-3 payment-option">
                        <input type="radio" name="PhuongThucThanhToan" value="BankTransfer" class="form-check-input mt-0">
                        <i class="fas fa-university fa-lg" style="width: 30px; margin: 0 15px; text-align: center;"></i>
                        <div class="flex-fill">
                            <strong class="d-block">Chuyển khoản ngân hàng</strong>
                            <small class="text-muted">Bạn sẽ nhận thông tin chuyển khoản sau khi hoàn tất.</small>
                        </div>
                    </label>
                </div>

                <h2 class="h4 mt-5 mb-3"><i class="fas fa-pencil-alt text-primary me-2"></i> 3. Ghi chú (Tùy chọn)</h2>
                @Html.TextAreaFor(m => m.ghichu, new { @class = "form-control", rows = 4, placeholder = "Bạn có yêu cầu đặc biệt gì không? (Ví dụ: Yêu cầu ăn chay, cần hỗ trợ xe lăn...)" })

                <hr class="my-4">

                <div class="text-end">
                    <button type="submit" class="btn btn-primary btn-lg fw-bold px-5 py-3">
                        Xác nhận và Thanh toán
                    </button>
                </div>
                <div class="text-end mt-2">
                    <small class="text-muted">
                        Bằng cách nhấn nút, bạn đồng ý với <a href="#">Điều khoản Dịch vụ</a>.
                    </small>
                </div>

            </div>

            <div class="col-lg-5">
                <div class="position-sticky" style="top: 20px;">
                    <div class="card shadow-lg border-0 bg-light">
                        <img src="@Url.Content("~/img/Destination/"+Model.Tour.anhmota)" class="card-img-top" alt="@Model.Tour.TenTour">
                        <div class="card-body p-4">
                            <h4 class="card-title mb-3">@Model.Tour.TenTour</h4>

                            <ul class="list-unstyled mb-4">
                                <li class="d-flex justify-content-between mb-2">
                                    <span class="text-muted">Ngày khởi hành:</span>
                                    <strong>@Model.NgayDi.ToString("dd/MM/yyyy")</strong>
                                </li>
                                <li class="d-flex justify-content-between mb-2">
                                    <span class="text-muted">Số lượng:</span>
                                    <strong>@Model.SoNguoi người</strong>
                                </li>
                                <li class="d-flex justify-content-between mb-2">
                                    <span class="text-muted">Đơn giá:</span>
                                    <span>@(((decimal)Model.Tour.Gia).ToString("N0")) $</span>
                                </li>
                            </ul>

                            <hr>

                            <div class="d-flex justify-content-between fs-4 fw-bold mb-4">
                                <span>Tổng cộng:</span>
                                <span class="text-primary">@Model.TongGia.Value.ToString("N0") $</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    }
</div>